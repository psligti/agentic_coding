/* OpenCode TUI - Main SCSS Stylesheet
 * Based on modern TUI design principles inspired by posting app
 * Focus on compact layouts, clear visual hierarchy, and smooth interactions
 */

* {
  scrollbar-color: $primary 10%;
  scrollbar-color-hover: $primary 80%;
  scrollbar-color-active: $primary;
  scrollbar-background: $surface-darken-1;
  scrollbar-background-hover: $surface-darken-1;
  scrollbar-background-active: $surface-darken-1;
  scrollbar-size-vertical: 1;

  &:focus {
    scrollbar-color: $primary 50%;
  }
}

/* ========================================
   Root and Base Styles
   ======================================== */

Screen {
  background: $background;
}

OpenCodeTUI {
  layout: horizontal;

  &.compact {
    & Screen {
      padding: 0;
    }
  }
}

/* ========================================
   Modal Screens
   ======================================== */

ModalScreen {
  background: black 40%;
  align: center middle;

  & > Vertical {
    background: $surface;
    border: thick $accent 60%;
    border-title-color: $text-accent;
    border-title-style: bold;
    border-subtitle-color: $text-muted;
    border-subtitle-style: none;
    padding: 1 2;
    min-width: 60;
    max-width: 100;
  }
}

.modal-body {
  background: $background;
  padding: 1 2;
  width: 100%;
  max-width: 80;
}

/* ========================================
   Header & Footer
   ======================================== */

AppHeader {
  color: $text-primary;
  padding: 0 1;
  height: 3;
  border-bottom: solid $primary 20%;
  background: $surface-darken-2;

  & > #app-user-host {
    dock: right;
    color: $text-muted;
  }
}

SessionHeader {
  padding: 0 1;
  height: auto;
  background: $surface-darken-1;
  border-bottom: solid $accent 30%;
}

SessionFooter {
  padding-left: 1;
  background: $surface;
  border-top: solid $primary 20%;
}

Footer {
  padding: 0 1;
  background: $surface-darken-2;
  border-top: solid $primary 20%;
}

/* ========================================
   Drawer Widget
   ======================================== */

DrawerWidget {
  dock: right;
  width: 40%;
  max-width: 60;
  min-width: 30;
  background: $surface;
  border-left: solid $accent 40%;

  & TabButton {
    padding: 0 1;
    margin: 0 0 1 0;
    border: none;
    background: transparent;
    text-align: center;
    width: 100%;

    &:hover {
      background: $surface-lighten-1;
    }

    &.-active {
      background: $accent-muted;
      text-style: bold;
    }
  }

  & TodoList,
  & SubagentList,
  & NavigatorList {
    height: 1fr;
    padding: 0;

    & .todo-item,
    & .subagent-item,
    & .nav-item {
      padding: 0 1;
      border-bottom: solid $primary 15%;
      color: $text-primary;

      &:hover {
        background: $surface-lighten-1;
      }
    }

    & .todo-completed {
      text-style: dim;
      color: $success;
    }

    & .status-running {
      color: $success;
    }

    & .status-blocked {
      color: $error;
    }
  }
}

/* ========================================
   DataTable Styles
   ======================================== */

DataTable {
  height: auto;
  width: 1fr;
  padding: 0;
  background: $surface;

  &.--header {
    color: $text-accent;
    background: $accent-muted;
    text-style: bold;
  }

  &.--cursor {
    background: $primary;
    color: $text-on-primary;
  }

  &:focus {
    outline: outer $accent;
    padding: 0;
  }

  &.--cell {
    padding: 0 1;
    border-bottom: solid $primary 15%;
  }
}

/* ========================================
   Input & TextArea Styles
   ======================================== */

Input {
  border: solid $primary 40%;
  width: 1fr;
  padding: 0 1;
  height: 1;
  margin: 0;
  background: $surface-lighten-1;

  &.-invalid {
    border-left: thick $error;
  }

  &:focus {
    border: solid $accent;
    padding: 0 1;
  }
}

TextArea {
  border: solid $primary 40%;
  padding: 0 1;
  background: $surface-lighten-1;

  &:focus {
    border: solid $accent;
    padding: 0 1;
  }

  &.empty {
    & .text-area--cursor-line {
      background: transparent;
    }

    & .text-area--cursor-gutter {
      background: transparent;
    }
  }
}

/* ========================================
   Button Styles
   ======================================== */

Button {
  padding: 0 2;
  height: 1;
  border: solid $primary 40%;
  background: $surface;
  color: $text-primary;
  min-width: 10;

  &:disabled {
    opacity: 40%;
  }

  &:hover {
    background: $surface-lighten-1;
    border-color: $accent 60%;
  }

  &.-primary {
    background: $primary;
    color: $text-on-primary;
    border-color: transparent;

    &:hover {
      background: $primary-darken-1;
    }
  }

  &.-success {
    background: $success;
    color: $text-on-success;
    border-color: transparent;
  }

  &.-danger {
    background: $error;
    color: $text-on-error;
    border-color: transparent;
  }
}

/* ========================================
   Tabs Styles
   ======================================== */

Tabs {
  height: 1;
  border-bottom: solid $primary 40%;
}

TabPane {
  padding: 0;
  background: $background;
}

/* ========================================
   Command Palette Styles
   ======================================== */

CommandPalette {
  background: black 50%;
  align: center middle;
  max-width: 70;

  & > Vertical {
    margin-top: 1;
    width: 100%;
    max-height: 70vh;
    background: $surface;
    border: wide $accent 80%;
  }

  & CommandInput {
    height: 3;
    border: none;
    padding: 0 1;
    width: 100%;
    background: $surface-lighten-1;
  }

  & CommandList {
    width: 100%;
    border: none;
    max-height: 60vh;
    padding: 0;
    background: $surface;

    & > .option-list--option {
      padding: 0 1;
      border-bottom: solid $primary 10%;

      &:hover {
        background: $accent-muted;
        color: $text-accent;
      }
    }
  }
}

/* ========================================
   Section Containers
   ======================================== */

.section {
  border: solid $accent 40%;
  border-subtitle-color: $text-accent 60%;
  border-subtitle-align: left;
  padding: 1;
  margin: 1 0;
  background: $surface;

  &:focus-within {
    border-color: $accent;
    border-subtitle-color: $text-accent;
  }
}

.home-header {
  padding: 1 2;
  background: $accent-muted;
  border-bottom: solid $accent 60%;
  color: $text-accent;
  text-style: bold;
}

/* ========================================
   Home Screen Styles
   ======================================== */

HomeScreen {
  & #provider-info {
    padding: 1 2;
    background: $accent-muted;
    border-bottom: solid $accent 60%;
  }

  & #recent-sessions,
  & #quick-actions {
    padding: 1;
    margin: 1 0;
    background: $surface;
    border: solid $primary 20%;
  }

  & DataTable {
    &.--header {
      color: $text-accent;
      background: $accent-muted;
      text-style: bold;
    }

    &.--cursor {
      background: $primary;
      color: $text-on-primary;
    }
  }
}

/* ========================================
   Session List Styles
   ======================================== */

SessionListScreen {
  background: $background;

  & DataTable {
    height: 1fr;
    max-height: 1fr;
  }
}

/* ========================================
   Settings Screen Styles
   ======================================== */

SettingsScreen {
  background: $background;
  padding: 1;

  & .settings-section {
    border: solid $accent 40%;
    padding: 1;
    margin: 1 0;
    background: $surface;

    &:focus-within {
      border-color: $accent;
    }
  }

  & .settings-label {
    color: $text-muted;
    margin-bottom: 1;
  }

  & .settings-value {
    color: $text-primary;
  }
}

/* ========================================
   Provider Settings Styles
   ======================================== */

ProviderSettingsScreen,
AccountSettingsScreen {
  background: $background;
  padding: 1;

  & DataTable {
    height: 1fr;
  }
}

/* ========================================
   Skills Panel Styles
   ======================================== */

SkillsPanelScreen {
  background: $background;
  padding: 1;

  & DataTable {
    &.--cell {
      padding: 0 1;
    }

    & .skill-enabled {
      color: $success;
      text-style: bold;
    }

    & .skill-disabled {
      color: $text-muted;
      text-style: dim;
    }

    & .skill-blocked {
      color: $error;
    }
  }
}

/* ========================================
   Tools Panel Styles
   ======================================== */

ToolsPanelScreen {
  background: $background;
  padding: 1;

  & DataTable {
    & .tool-allowed {
      color: $success;
    }

    & .tool-denied {
      color: $error;
    }

    & .tool-unspecified {
      color: $warning;
    }
  }
}

/* ========================================
   Log Viewer Styles
   ======================================== */

ToolLogViewerScreen {
  background: $background;
  padding: 1;

  & .log-entry {
    padding: 0 1;
    border-bottom: solid $primary 10%;
    font-family: monospace;
  }

  & .log-success {
    color: $success;
  }

  & .log-error {
    color: $error;
  }

  & .log-info {
    color: $text-muted;
  }
}

/* ========================================
   Theme Settings Styles
   ======================================== */

ThemeSettingsScreen {
  background: $background;
  padding: 1;

  & .theme-preview {
    border: solid $accent 40%;
    padding: 1;
    margin: 1 0;
    background: $surface;
  }

  & .theme-option {
    padding: 1;
    margin: 0 0 1 0;
    border: solid $primary 20%;
    background: $surface;

    &:hover {
      background: $accent-muted;
      border-color: $accent;
    }

    &.-active {
      background: $accent;
      color: $text-on-accent;
      border-color: $accent;
    }
  }
}

/* ========================================
   Response Area Styles
   ======================================== */

ResponseArea {
  border-subtitle-color: $text-muted;
  padding: 1;
  background: $surface-darken-1;

  &.empty {
    display: none;
  }

  &.success .border-title-status {
    color: $text-success;
    background: $success-muted;
  }

  &.warning .border-title-status {
    color: $text-warning;
    background: $warning-muted;
  }

  &.error .border-title-status {
    color: $text-error;
    background: $error-muted;
  }
}

/* ========================================
   Message Screen Styles
   ======================================== */

MessageScreen {
  background: $background;

  & .message {
    padding: 1;
    margin: 0 1;
    border: solid $primary 15%;
    background: $surface;

    &.user {
      background: $primary-muted;
    }

    &.assistant {
      background: $accent-muted;
    }

    &.system {
      color: $text-muted;
      text-style: dim;
    }
  }
}

/* ========================================
   Utility Classes
   ======================================== */

.hidden {
  display: none;
}

.w-auto {
  width: auto;
}

.text-muted {
  color: $text-muted;
}

.text-accent {
  color: $text-accent;
}

.text-success {
  color: $text-success;
}

.text-warning {
  color: $text-warning;
}

.text-error {
  color: $text-error;
}

/* ========================================
   Compact Mode Styles
   ======================================== */

OpenCodeTUI {
  &.-compact {
    & AppHeader,
    & SessionHeader,
    & SessionFooter {
      padding: 0;
      height: 2;
    }

    & Section {
      padding: 0 0 0 0;
      margin: 0 0 0 1;
      border: none;
    }

    & Button {
      padding: 0 1;
      min-width: 8;
    }

    & DataTable {
      &.--cell {
        padding: 0;
      }
    }
  }
}

/* ========================================
   Focus & Selection States
   ======================================== */

:focus {
  outline: inner $accent;
  outline-offset: 0;
}

:focus-within {
  border-color: $accent;
}

/* ========================================
   Status Indicators
   ======================================== */

.status-indicator {
  display: inline-block;
  width: 1;
  height: 1;
  border-radius: 50%;
  margin-right: 1;

  &.success {
    background: $success;
  }

  &.warning {
    background: $warning;
  }

  &.error {
    background: $error;
  }

  &.info {
    background: $primary;
  }
}

/* ========================================
   Empty States
   ======================================== */

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 10;
  color: $text-muted;
  text-style: dim;

  & .empty-icon {
    font-size: 3;
    margin-bottom: 1;
  }

  & .empty-text {
    color: $text-muted;
  }
}

/* ========================================
   Loading States
   ======================================== */

.loading {
  opacity: 60%;
  pointer-events: none;
}

.loading-spinner {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
